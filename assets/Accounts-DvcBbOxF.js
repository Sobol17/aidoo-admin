import{s as X}from"./index-B1O_roLE.js";import{s as Y}from"./index-C0k0BVDM.js";import{s as Z}from"./index-C-zIenvA.js";import{s as z,a as ee}from"./index-CRMrgCsE.js";import{s as te}from"./index-BOXa9Jy8.js";import{s as oe}from"./index-CxNTl2I9.js";import{u as le,a as ae,b as se,c as ie}from"./useAdminAccounts-Bctc6_nv.js";import{aR as re,aS as V,aD as ne,r as d,a0 as de,c as v,a,d as t,g as r,aT as i,aU as ue,o as b,F as k,H as ce,I as pe}from"./index-B9WMAgPp.js";import{s as u}from"./index-BAUH0ml_.js";import"./index-uurWoLOS.js";import"./index-DsYEzwOE.js";import"./index-C7xObSHm.js";import"./index-DWLvmoye.js";import"./index-CqPY98u6.js";import"./index-B5GLnlRG.js";import"./index-nszv79N2.js";import"./index-D2QTpbNw.js";import"./index-DRcKLDty.js";import"./index-BbQFmVAV.js";import"./index-DOZc9ZBs.js";import"./index-Bpy52-VE.js";import"./index-CkapM4k5.js";import"./index-Bx8IZfT9.js";import"./index-Dcgh8jvp.js";import"./index-BEpbll0U.js";import"./formatDate-l4zQ4D13.js";const me={class:"card"},fe={class:"flex flex-wrap gap-2 items-center justify-between"},ve={class:"flex flex-col gap-6"},be={key:0},ge={key:0,class:"text-red-500"},we={key:0,class:"text-red-500"},ye={class:"flex justify-between items-end gap-x-3 mb-4"},he={class:"grow"},ke={key:0,class:"text-red-500"},_e={class:"flex items-center gap-4"},Ye={__name:"Accounts",setup(xe){const P=re(),{data:_,isLoading:I,error:De}=le(),$=V(()=>(_==null?void 0:_.value)||[]),p=ne(),N=d(),m=d(!1),f=d(!1),x=d({global:{value:null,matchMode:de.CONTAINS}}),D=d(null),g=d(!1),o=d({phone:"",password:""}),C=V(()=>parseInt(o.value.phone.replace(/\D/g,""))),{mutate:T,isPending:M}=ae({onSuccess:()=>{p.add({severity:"success",summary:"Успех",detail:"Аккаунт успешно создан",life:3e3}),w()},onError:s=>{p.add({severity:"error",summary:"Ошибка",detail:"Не удалось создать аккаунт",life:3e3})}}),{mutate:R}=se({onSuccess:()=>{p.add({severity:"success",summary:"Успех",detail:"Аккаунт успешно обновлен",life:3e3}),w()},onError:s=>{p.add({severity:"error",summary:"Ошибка",detail:"Не удалось обновить аккаунт",life:3e3})}});function S(){g.value?R({id:o.value.id,accountData:{is_blocked:!0,phone:C.value,password:o.value.password,profile_id:P.profileID}}):T({phone:C.value,password:o.value.password,profile_id:P.profileID})}const n=d(!1);function U(){g.value=!1,o.value={phone:"",password:""},n.value=!1,m.value=!0}function w(){m.value=!1,f.value=!1,n.value=!1}function L(s){g.value=!0,o.value={...s},m.value=!0}function E(s){D.value=s.id,f.value=!0}const{mutate:F,isPending:B}=ie({onSuccess:()=>{p.add({severity:"success",summary:"Успех",detail:"Аккаунт успешно удален",life:3e3}),w()},onError:s=>{p.add({severity:"error",summary:"Ошибка",detail:"Не удалось удалить аккаунт",life:3e3})}});function q(){F(D.value)}function H(){let s="";const e="abcdef0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()";for(let y=0;y<10;y++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}function O(){o.value.password=H()}const j=ue();function K(s){j.push(`/admin-accounts/${s.data.id}`)}return(s,e)=>{const y=oe,G=ee,h=te,J=z,c=Z,Q=Y,A=X;return b(),v("div",null,[a("div",me,[t(y,{class:"mb-6"},{end:r(()=>[t(i(u),{label:"Добавить",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:U})]),_:1}),t(Q,{ref_key:"dt",ref:N,value:$.value,stripedRows:"",dataKey:"id",paginator:!0,rows:10,filters:x.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"{first} до {last} из {totalRecords} элементов",onRowClick:K,rowHover:!0,selectionMode:"single",loading:i(I)},{header:r(()=>[a("div",fe,[e[8]||(e[8]=a("h4",{class:"m-0"},"Аккаунты (ПУ)",-1)),t(J,null,{default:r(()=>[t(G,null,{default:r(()=>e[7]||(e[7]=[a("i",{class:"pi pi-search"},null,-1)])),_:1}),t(h,{modelValue:x.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>x.value.global.value=l),placeholder:"Поиск"},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(c,{field:"creatorID",header:"Создатель (ID)",sortable:"",style:{"min-width":"12rem"}}),t(c,{field:"phone",header:"Телефон",sortable:"",style:{"min-width":"16rem"}}),t(c,{field:"password",header:"Пароль",style:{"min-width":"16rem"}}),t(c,{field:"id",header:"ID",sortable:"",style:{"min-width":"16rem"}}),t(c,{field:"createdAt",header:"Дата создания",sortable:"",style:{"min-width":"12rem"}}),t(c,{field:"updatedAt",header:"Дата обновления",sortable:"",style:{"min-width":"12rem"}}),t(c,{exportable:!1,style:{"min-width":"12rem"}},{body:r(l=>[t(i(u),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:W=>L(l.data)},null,8,["onClick"]),t(i(u),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:W=>E(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),t(A,{visible:m.value,"onUpdate:visible":e[4]||(e[4]=l=>m.value=l),style:{width:"450px"},header:"Информация об аккаунте",modal:!0},{footer:r(()=>[t(i(u),{label:"Отменить",icon:"pi pi-times",text:"",onClick:w}),t(i(u),{label:"Сохранить",icon:"pi pi-check",onClick:S})]),default:r(()=>[a("div",ve,[g.value?(b(),v("div",be,[e[9]||(e[9]=a("label",{for:"name",class:"block font-bold mb-3"},"ID",-1)),t(h,{id:"id",modelValue:o.value.id,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.id=l),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:n.value&&!o.value.id,fluid:"",disabled:""},null,8,["modelValue","invalid"]),n.value&&!o.value.id?(b(),v("small",ge,"Обязательное поле")):k("",!0)])):k("",!0),a("div",null,[e[10]||(e[10]=a("label",{for:"name",class:"block font-bold mb-3"},"Телефон",-1)),t(h,{id:"phone",modelValue:o.value.phone,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.phone=l),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:n.value&&!o.value.phone,fluid:""},null,8,["modelValue","invalid"]),n.value&&!o.value.phone?(b(),v("small",we,"Обязательное поле")):k("",!0)]),a("div",ye,[a("div",he,[e[11]||(e[11]=a("label",{for:"name",class:"block font-bold mb-3"},"Пароль",-1)),t(h,{id:"name",modelValue:o.value.password,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.password=l),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:n.value&&!o.value.password,fluid:""},null,8,["modelValue","invalid"]),n.value&&!o.value.password?(b(),v("small",ke,"Обязательное поле")):k("",!0)]),t(i(u),{onClick:O,class:"shrink-0",label:"Сгенерировать",outlined:"",loading:i(M)},null,8,["loading"])])])]),_:1},8,["visible"]),t(A,{visible:f.value,"onUpdate:visible":e[6]||(e[6]=l=>f.value=l),style:{width:"450px"},header:"Подтверждение",modal:!0},{footer:r(()=>[t(i(u),{label:"Нет",icon:"pi pi-times",text:"",onClick:e[5]||(e[5]=l=>f.value=!1)}),t(i(u),{label:"Да",icon:"pi pi-check",onClick:q,loading:i(B)},null,8,["loading"])]),default:r(()=>[a("div",_e,[e[12]||(e[12]=a("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),ce(" Вы уверены, что хотите удалить аккаунт c id "+pe(D.value)+"? ",1)])]),_:1},8,["visible"])])}}};export{Ye as default};
