import{s as j}from"./index-DPCV2Ee5.js";import{s as M}from"./index-BITpGhP1.js";import{s as O}from"./index-BTML_cXl.js";import{s as q}from"./index-CGhCaLS4.js";import{s as E}from"./index-DXjTDYQh.js";import{s as K}from"./index-Dlue8Cix.js";import{s as Q,a as W}from"./index-BPJ3xovF.js";import{s as z}from"./index-DC1oGjXQ.js";import{aV as H,aQ as $,aW as Z,aZ as G,aR as J,aD as X,r as p,a0 as Y,c as f,a as s,d as e,g as n,aS as b,o as c,f as ee,I as te,F as I}from"./index-z1uXvXEi.js";import{f as N}from"./formatDate-l4zQ4D13.js";import{s as w}from"./index-DYBcNESa.js";import"./index-DFvs91Rb.js";import"./index-DR_CA7HW.js";import"./index-ibAaKPa9.js";import"./index-1vWsUMNt.js";import"./index-BoxnDY_1.js";import"./index-BYMwb912.js";import"./index-57ubhNbJ.js";import"./index-BXRqlT2O.js";import"./index-DWl0dXX8.js";import"./index-Bw8snGY9.js";import"./index-Sl98z5SM.js";import"./index-BpAzr15_.js";import"./index-dXz3bja4.js";import"./index-DX0VtpCH.js";import"./index-DxE9uxNC.js";const ae="/user-profiles",le=(i="all",v="all",d="",h=1,g=10,y="")=>H.get(`${ae}${d?`?search=${d}&`:"?"}page=${h}&limit=${g}&status=${i}&profile_type=${v}&profile_id=${y}`).then(u=>u.data);function re(i){return i==="admin"?"Администратор":i==="moderator"?"Модератор":i==="supporter"?"Спонсор":i==="employee"?"Сотрудник":"Неизвестно"}function oe(i){return i==="actived"?"Активный":i==="inactive"?"Неактивный":i==="blocked"?"Заблокирован":"Неизвестно"}function se(i,v,d,h,g){const y=$();return Z({queryKey:["user-profiles"],queryFn:()=>le(i,v,d,h,g,y.profileID),placeholderData:G,staleTime:5*60*1e3,cacheTime:5*60*1e3,select:u=>u&&u.documents&&u.documents.length>0?u.documents.map(r=>({createdAt:N(r.created_at),updatedAt:N(r.updated_at),accountId:r.account_id,creatorId:r.creator_id,phone:r.phone,profileType:re(r.profile_type),avatar:r.avatar_id,firstName:r.first_name,lastName:r.last_name,city:r.city,id:r._id,status:oe(r.status),partner:r.partner_info})):null})}const ie={class:"card"},ne={class:"flex flex-wrap gap-2 items-center justify-between"},de={key:1,class:"flex items-center justify-center size-10 bg-gray-200 rounded-full"},ue={key:0,class:"p-4"},me={key:1},pe={class:"flex flex-col gap-6"},ce={key:0,class:"text-red-500"},fe={key:0,class:"text-red-500"},qe={__name:"UserProfiles",setup(i){const v=$(),{data:d,isLoading:h,error:g}=se("all"),y=J(()=>(d==null?void 0:d.value)||[]);X();const u=p(),_=p(!1),r=p({global:{value:null,matchMode:Y.CONTAINS}}),D=p([{name:"Активный",code:"active"},{name:"Неактивный",code:"inactive"},{name:"Заблокирован",code:"blocked"}]),o=p({firstName:"",lastName:"",phone:"",city:"",accountId:"",profileType:""});function T(){m.value=!0,createProfile({profile_id:v.profileID,phone:numericPhone.value,profile_type:o.value.profileType.code,account_id:o.value.accountId.code,first_name:o.value.firstName,last_name:o.value.lastName,city:o.value.city})}const m=p(!1);function V(k){o.value={firstName:"",lastName:"",phone:"",city:"",accountId:k.data.accountId,profileType:""},m.value=!1,_.value=!0}function R(){_.value=!1,m.value=!1}const x=p([]);return(k,t)=>{const L=W,C=z,U=Q,a=K,A=E,P=q,S=O,F=M,B=j;return c(),f("div",null,[s("div",ie,[e(P,{expandedRows:x.value,"onUpdate:expandedRows":t[1]||(t[1]=l=>x.value=l),ref_key:"dt",ref:u,value:y.value,stripedRows:"",dataKey:"id",paginator:!0,rows:10,filters:r.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"{first} до {last} из {totalRecords} элементов",rowHover:!0,loading:b(h)},{header:n(()=>[s("div",ne,[t[6]||(t[6]=s("h4",{class:"m-0"},"Профили (МП)",-1)),e(U,null,{default:n(()=>[e(L,null,{default:n(()=>t[5]||(t[5]=[s("i",{class:"pi pi-search"},null,-1)])),_:1}),e(C,{modelValue:r.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=l=>r.value.global.value=l),placeholder:"Поиск"},null,8,["modelValue"])]),_:1})])]),expansion:n(l=>[l.data.partner?(c(),f("div",ue,[s("h5",null," Информация о партнере "+te(l.data.partner.short_name),1),e(P,{value:l.data.partner},{default:n(()=>[e(a,{field:"short_name",header:"Краткое название",sortable:""}),e(a,{field:"full_name",header:"Полное название",sortable:""}),e(a,{field:"phone",header:"Телефон",sortable:""}),e(a,{field:"city",header:"Город",sortable:""}),e(a,{field:"email",header:"Email",sortable:""}),e(a,{field:"whatsapp",header:"Whatsapp",sortable:""}),e(a,{field:"telegram",header:"Telegram",sortable:""}),e(a,{field:"inn",header:"ИНН",sortable:""}),e(a,{headerStyle:"width:4rem"},{body:n(()=>[e(b(w),{icon:"pi pi-search"})]),_:1})]),_:2},1032,["value"])])):(c(),f("div",me,t[8]||(t[8]=[s("h5",null,"Информация о партнере отсутствует",-1)])))]),empty:n(()=>t[9]||(t[9]=[s("div",{class:"flex items-center justify-center"},[s("div",{class:"text-gray-500 text-lg py-8"}," Нет данных для отображения ")],-1)])),default:n(()=>[e(a,{expander:"",style:{width:"5rem"}}),e(a,{field:"avatar",header:"Аватар",sortable:"",style:{"min-width":"8rem"}},{body:n(l=>[l.data.avatar?(c(),ee(A,{key:0,image:l.data.avatar,shape:"circle"},null,8,["image"])):(c(),f("div",de,t[7]||(t[7]=[s("i",{class:"pi pi-user"},null,-1)])))]),_:1}),e(a,{field:"accountId",header:"Аккаунт (ID)",sortable:"",style:{"min-width":"12rem"}}),e(a,{field:"creatorId",header:"Создатель (ID)",sortable:"",style:{"min-width":"12rem"}}),e(a,{field:"phone",header:"Телефон",sortable:"",style:{"min-width":"12rem"}}),e(a,{field:"firstName",header:"Имя",sortable:"",style:{"min-width":"8rem"}}),e(a,{field:"lastName",header:"Фамилия",sortable:"",style:{"min-width":"10rem"}}),e(a,{field:"city",header:"Город",sortable:"",style:{"min-width":"10rem"}}),e(a,{field:"status",header:"Статус",sortable:"",style:{"min-width":"10rem"}}),e(a,{field:"profileType",header:"Роль",style:{"min-width":"10rem"}}),e(a,{field:"id",header:"ID профиля",sortable:"",style:{"min-width":"16rem"}}),e(a,{field:"createdAt",header:"Дата создания",sortable:"",style:{"min-width":"12rem"}}),e(a,{field:"updatedAt",header:"Дата обновления",sortable:"",style:{"min-width":"12rem"}}),e(a,{exportable:!1,style:{"min-width":"12rem"}},{body:n(l=>[e(b(w),{icon:"pi pi-file-edit",class:"mr-2",outlined:"",label:"Модерирование",severity:"help",onClick:ve=>V(l)},null,8,["onClick"])]),_:1})]),_:1},8,["expandedRows","value","filters","loading"])]),e(B,{visible:_.value,"onUpdate:visible":t[4]||(t[4]=l=>_.value=l),style:{width:"450px"},header:"Модерирование профиля (МП)",modal:!0},{footer:n(()=>[e(b(w),{label:"Отменить",icon:"pi pi-times",text:"",onClick:R}),e(b(w),{label:"Сохранить",icon:"pi pi-check",onClick:T})]),default:n(()=>[s("div",pe,[s("div",null,[t[10]||(t[10]=s("div",{class:"block font-bold mb-3"},"Статус профиля",-1)),e(S,{modelValue:o.value.status,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.status=l),options:D.value,optionLabel:"name",placeholder:"Выберите статус",class:"w-full",invalid:m.value&&!o.value.status},null,8,["modelValue","options","invalid"]),m.value&&!o.value.status?(c(),f("small",ce,"Обязательное поле")):I("",!0)]),s("div",null,[t[11]||(t[11]=s("div",{class:"block font-bold mb-3"},"Комментарий модератора",-1)),e(F,{modelValue:o.value.comment,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.comment=l),placeholder:"Комментарий",class:"w-full",invalid:m.value&&!o.value.comment},null,8,["modelValue","invalid"]),m.value&&!o.value.comment?(c(),f("small",fe,"Обязательное поле")):I("",!0)])])]),_:1},8,["visible"])])}}};export{qe as default};
