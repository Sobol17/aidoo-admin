import{s as Z}from"./index-CIEqmJiy.js";import{s as ee}from"./index-BN9m-r41.js";import{s as te}from"./index-4fOzUgMh.js";import{s as ae}from"./index-SgKG7yg9.js";import{s as le}from"./index-5B64Yr3S.js";import{s as oe,a as ie}from"./index-DiuPxqIt.js";import{s as se}from"./index-sGnuCcFG.js";import{s as re}from"./index-BvTC_-DX.js";import{aQ as ne,aU as ue,aR as de,aD as me,r as n,a0 as ce,c as g,a as o,d as t,g as r,aS as s,aT as pe,o as b,I,F as _,H as ve}from"./index-2t5m_B8U.js";import{u as fe,a as ge,b as be,c as ye}from"./useSubcategories-DQQKjwX1.js";import{c as D}from"./categoriesData-Bm6MGxRc.js";import{s as m}from"./index-BaljtHQq.js";import"./index-CYXz2DcT.js";import"./index-BikcCgXV.js";import"./index-CxhJ11wg.js";import"./index-BMU5YOwo.js";import"./index-DPEEpFT8.js";import"./index-C01u9b3T.js";import"./index-rz7XOXGG.js";import"./index-CmIjS8jF.js";import"./index-CmW33vwP.js";import"./index-DWvw7VAr.js";import"./index--rAq6gtP.js";import"./index-CDm_ImpW.js";import"./index-BhExmjrM.js";import"./index-FUaIQbcE.js";import"./index-hgfqQAcA.js";import"./formatDate-l4zQ4D13.js";const _e={class:"card"},ke={class:"flex flex-wrap gap-2 items-center justify-between"},we={class:"m-0"},xe={class:"flex flex-col gap-6"},Pe={key:0},Se={key:0,class:"text-red-500"},De={key:0,class:"text-red-500"},Ce={class:"mb-4"},Ve={key:0,class:"text-red-500"},he={class:"mb-4"},$e={class:"flex items-center gap-4"},st={__name:"Subcategories",setup(Ie){const C=ne(),k=ue(),N=D.find(i=>i.code===k.params.id),{data:w,isLoading:T,error:Ne}=fe(k.params.id),R=de(()=>(w==null?void 0:w.value)||[]),c=me(),U=n(),p=n(!1),v=n(!1),x=n({global:{value:null,matchMode:ce.CONTAINS}}),V=n(null),h=n(null),f=n(!1),a=n({}),{mutate:L,isPending:M}=ge({onSuccess:()=>{c.add({severity:"success",summary:"Успех",detail:"Подкатегория успешно создана",life:3e3}),y()},onError:i=>{c.add({severity:"error",summary:"Ошибка",detail:"Не удалось создать подкатегорию",life:3e3})}}),{mutate:A}=be({onSuccess:()=>{c.add({severity:"success",summary:"Успех",detail:"Подкатегория успешно обновлена",life:3e3}),y()},onError:i=>{c.add({severity:"error",summary:"Ошибка",detail:"Не удалось обновить подкатегорию",life:3e3})}});function F(){f.value?A({id:a.value.id,subcategoryData:{name:a.value.name,category:a.value.parent.code,is_premium:!!a.value.isPremium,profile_id:C.profileID}}):L({name:a.value.name,category:a.value.parent.code,is_premium:!!a.value.isPremium,profile_id:C.profileID})}const u=n(!1);function B(){f.value=!1,a.value={},u.value=!1,p.value=!0}function y(){p.value=!1,v.value=!1,u.value=!1}function E(i){f.value=!0;const e=D.find(P=>P.code===i.category);a.value={...i,parent:e},p.value=!0}function O(i){V.value=i.id,h.value=i.name,v.value=!0}const{mutate:q,isPending:H}=ye({onSuccess:()=>{c.add({severity:"success",summary:"Успех",detail:"Аккаунт успешно удален",life:3e3}),y()},onError:i=>{c.add({severity:"error",summary:"Ошибка",detail:"Не удалось удалить аккаунт",life:3e3})}});function j(){q(V.value)}const K=pe();function Q(i){K.push(`/categories/${k.params.id}/${i.data.id}`)}return(i,e)=>{const P=re,z=ie,S=se,G=oe,d=le,J=ae,W=te,X=ee,$=Z;return b(),g("div",null,[o("div",_e,[t(P,{class:"mb-6"},{end:r(()=>[t(s(m),{label:"Добавить",icon:"pi pi-plus",severity:"secondary",class:"mr-2",onClick:B})]),_:1}),t(J,{ref_key:"dt",ref:U,value:R.value,stripedRows:"",dataKey:"id",paginator:!0,rows:10,filters:x.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"{first} до {last} из {totalRecords} элементов",onRowClick:Q,rowHover:!0,selectionMode:"single",loading:s(T)},{header:r(()=>[o("div",ke,[o("h4",we,I(s(N).name)+", подкатегории",1),t(G,null,{default:r(()=>[t(z,null,{default:r(()=>e[8]||(e[8]=[o("i",{class:"pi pi-search"},null,-1)])),_:1}),t(S,{modelValue:x.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>x.value.global.value=l),placeholder:"Поиск"},null,8,["modelValue"])]),_:1})])]),default:r(()=>[t(d,{field:"name",header:"Название",sortable:"",style:{"min-width":"12rem"}}),t(d,{field:"categoryName",header:"Название родителя",style:{"min-width":"12rem"}}),t(d,{field:"category",header:"Родитель (ID)",sortable:"",style:{"min-width":"10rem"}}),t(d,{field:"id",header:"ID",sortable:"",style:{"min-width":"16rem"}}),t(d,{field:"isPremium",header:"Премиум",sortable:"",style:{"min-width":"12rem"}}),t(d,{field:"createdAt",header:"Дата создания",sortable:"",style:{"min-width":"12rem"}}),t(d,{field:"updatedAt",header:"Дата обновления",sortable:"",style:{"min-width":"12rem"}}),t(d,{exportable:!1,style:{"min-width":"12rem"}},{body:r(l=>[t(s(m),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:Y=>E(l.data)},null,8,["onClick"]),t(s(m),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:Y=>O(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),t($,{visible:p.value,"onUpdate:visible":e[5]||(e[5]=l=>p.value=l),style:{width:"450px"},header:f.value?"Изменить подкатегорию":"Добавить подкатегорию",modal:!0},{footer:r(()=>[t(s(m),{label:"Отменить",icon:"pi pi-times",text:"",onClick:y}),t(s(m),{label:"Сохранить",icon:"pi pi-check",onClick:F,loading:s(M)},null,8,["loading"])]),default:r(()=>[o("div",xe,[f.value?(b(),g("div",Pe,[e[9]||(e[9]=o("label",{for:"name",class:"block font-bold mb-3"},"ID",-1)),t(S,{id:"id",modelValue:a.value.id,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.id=l),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:u.value&&!a.value.id,fluid:"",disabled:""},null,8,["modelValue","invalid"]),u.value&&!a.value.id?(b(),g("small",Se,"Обязательное поле")):_("",!0)])):_("",!0),o("div",null,[e[10]||(e[10]=o("label",{for:"name",class:"block font-bold mb-3"},"Название",-1)),t(S,{id:"name",modelValue:a.value.name,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.name=l),modelModifiers:{trim:!0},required:"true",autofocus:"",invalid:u.value&&!a.value.name,fluid:""},null,8,["modelValue","invalid"]),u.value&&!a.value.name?(b(),g("small",De,"Обязательное поле")):_("",!0)]),o("div",Ce,[e[11]||(e[11]=o("div",{class:"block font-bold mb-3"},"Родительская категория",-1)),t(W,{modelValue:a.value.parent,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.parent=l),options:s(D),optionLabel:"name",placeholder:"Выберите родительскую категорию",class:"w-full",invalid:u.value&&!a.value.parent},null,8,["modelValue","options","invalid"]),u.value&&!a.value.parent?(b(),g("small",Ve,"Обязательное поле")):_("",!0)]),o("div",he,[e[12]||(e[12]=o("div",{class:"block font-bold mb-3"},"Премиум подкатегория",-1)),t(X,{modelValue:a.value.isPremium,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.isPremium=l)},null,8,["modelValue"])])])]),_:1},8,["visible","header"]),t($,{visible:v.value,"onUpdate:visible":e[7]||(e[7]=l=>v.value=l),style:{width:"450px"},header:"Подтверждение",modal:!0},{footer:r(()=>[t(s(m),{label:"Нет",icon:"pi pi-times",text:"",onClick:e[6]||(e[6]=l=>v.value=!1)}),t(s(m),{label:"Да",icon:"pi pi-check",onClick:j,loading:s(H)},null,8,["loading"])]),default:r(()=>[o("div",$e,[e[13]||(e[13]=o("i",{class:"pi pi-exclamation-triangle !text-3xl"},null,-1)),ve(" Вы уверены, что хотите удалить подкатегорию c названием "+I(h.value)+"? ",1)])]),_:1},8,["visible"])])}}};export{st as default};
