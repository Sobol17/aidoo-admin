import{s as M}from"./index-Cbx-Xfvc.js";import{s as j}from"./index-Dsa3CpLx.js";import{s as O}from"./index-9cNysORL.js";import{s as q}from"./index-DAfz9cxS.js";import{s as E}from"./index-BpuMiVmx.js";import{s as K}from"./index-BnGTPFe8.js";import{s as W,a as z}from"./index-B-plTx5G.js";import{s as H}from"./index-BXgqbUPL.js";import{aW as Q,aR as $,aX as X,a_ as G,aS as J,aD as Y,r as c,a0 as Z,c as k,a as i,d as e,g as n,aT as p,o as _,f as ee,I as te,F as I}from"./index-CDmxuMMJ.js";import{f as x}from"./formatDate-l4zQ4D13.js";import{s as b}from"./index-CRSqkw6W.js";import"./index-DbUt26i9.js";import"./index-C0olpeLK.js";import"./index-CUKIUHqa.js";import"./index-DUTCThoN.js";import"./index-C1Zg_0RS.js";import"./index-C6TfT_m9.js";import"./index-DfVd--a_.js";import"./index-eqHPU8fn.js";import"./index-DWQX1vuk.js";import"./index-CwvKv1mC.js";import"./index-CqZfXNqd.js";import"./index-X7T8uN8Y.js";import"./index-1HQRghiz.js";import"./index-CFlZEPEE.js";import"./index-DvEl5PVx.js";const ae="/user-profiles",le=(s="all",f="all",d="",v=1,g=10,h="")=>Q.get(`${ae}${d?`?search=${d}&`:"?"}page=${v}&limit=${g}&status=${s}&profile_type=${f}&profile_id=${h}`).then(u=>u.data);function re(s){return s==="admin"?"Администратор":s==="moderator"?"Модератор":s==="supporter"?"Спонсор":s==="employee"?"Сотрудник":"Неизвестно"}function oe(s){return s==="actived"?"Активный":s==="inactive"?"Неактивный":s==="blocked"?"Заблокирован":"Неизвестно"}function ie(s,f,d,v,g){const h=$();return X({queryKey:["user-profiles"],queryFn:()=>le(s,f,d,v,g,h.profileID),placeholderData:G,staleTime:5*60*1e3,cacheTime:5*60*1e3,select:u=>u&&u.documents&&u.documents.length>0?u.documents.map(l=>({createdAt:x(l.created_at),updatedAt:x(l.updated_at),accountId:l.account_id,creatorId:l.creator_id,phone:l.phone,profileType:re(l.profile_type),avatar:l.avatar_id,firstName:l.first_name,lastName:l.last_name,city:l.city,id:l._id,status:oe(l.status),partner:l.partner_info})):null})}const se={class:"card"},ne={class:"flex flex-wrap gap-2 items-center justify-between"},de={key:1,class:"flex items-center justify-center size-10 bg-gray-200 rounded-full"},ue={class:"p-4"},me={class:"flex flex-col gap-6"},ce={key:0,class:"text-red-500"},pe={key:0,class:"text-red-500"},je={__name:"UserProfiles",setup(s){const f=$(),{data:d,isLoading:v,error:g}=ie("all"),h=J(()=>(d==null?void 0:d.value)||[]);Y();const u=c(),y=c(!1),l=c({global:{value:null,matchMode:Z.CONTAINS}}),N=c([{name:"Активный",code:"active"},{name:"Неактивный",code:"inactive"},{name:"Заблокирован",code:"blocked"}]),o=c({firstName:"",lastName:"",phone:"",city:"",accountId:"",profileType:""});function D(){m.value=!0,createProfile({profile_id:f.profileID,phone:numericPhone.value,profile_type:o.value.profileType.code,account_id:o.value.accountId.code,first_name:o.value.firstName,last_name:o.value.lastName,city:o.value.city})}const m=c(!1);function T(w){o.value={firstName:"",lastName:"",phone:"",city:"",accountId:w.data.accountId,profileType:""},src.value=null,m.value=!1,y.value=!0}function C(){y.value=!1,m.value=!1}return(w,a)=>{const V=z,L=H,R=W,t=K,U=E,P=q,A=O,S=j,F=M;return _(),k("div",null,[i("div",se,[e(P,{ref_key:"dt",ref:u,value:h.value,stripedRows:"",dataKey:"id",paginator:!0,rows:10,filters:l.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"{first} до {last} из {totalRecords} элементов",onRowClick:T,rowHover:!0,selectionMode:"single",loading:p(v)},{header:n(()=>[i("div",ne,[a[5]||(a[5]=i("h4",{class:"m-0"},"Модерирование профилей (МП)",-1)),e(R,null,{default:n(()=>[e(V,null,{default:n(()=>a[4]||(a[4]=[i("i",{class:"pi pi-search"},null,-1)])),_:1}),e(L,{modelValue:l.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=r=>l.value.global.value=r),placeholder:"Поиск"},null,8,["modelValue"])]),_:1})])]),expansion:n(r=>[i("div",ue,[i("h5",null," Информация о партнере "+te(r.data.partner.short_name),1),e(P,{value:r.data.partner},{default:n(()=>[e(t,{field:"short_name",header:"Краткое название",sortable:""}),e(t,{field:"full_name",header:"Полное название",sortable:""}),e(t,{field:"phone",header:"Телефон",sortable:""}),e(t,{field:"city",header:"Город",sortable:""}),e(t,{field:"email",header:"Email",sortable:""}),e(t,{field:"whatsapp",header:"Whatsapp",sortable:""}),e(t,{field:"telegram",header:"Telegram",sortable:""}),e(t,{field:"inn",header:"ИНН",sortable:""}),e(t,{headerStyle:"width:4rem"},{body:n(()=>[e(p(b),{icon:"pi pi-search"})]),_:1})]),_:2},1032,["value"])])]),empty:n(()=>a[7]||(a[7]=[i("div",{class:"flex items-center justify-center"},[i("div",{class:"text-gray-500 text-lg py-8"}," Нет данных для отображения ")],-1)])),default:n(()=>[e(t,{expander:"",style:{width:"5rem"}}),e(t,{field:"avatar",header:"Аватар",sortable:"",style:{"min-width":"8rem"}},{body:n(r=>[r.data.avatar?(_(),ee(U,{key:0,image:r.data.avatar,shape:"circle"},null,8,["image"])):(_(),k("div",de,a[6]||(a[6]=[i("i",{class:"pi pi-user"},null,-1)])))]),_:1}),e(t,{field:"accountId",header:"Аккаунт (ID)",sortable:"",style:{"min-width":"12rem"}}),e(t,{field:"creatorId",header:"Создатель (ID)",sortable:"",style:{"min-width":"12rem"}}),e(t,{field:"phone",header:"Телефон",sortable:"",style:{"min-width":"12rem"}}),e(t,{field:"firstName",header:"Имя",sortable:"",style:{"min-width":"8rem"}}),e(t,{field:"lastName",header:"Фамилия",sortable:"",style:{"min-width":"10rem"}}),e(t,{field:"city",header:"Город",sortable:"",style:{"min-width":"10rem"}}),e(t,{field:"status",header:"Статус",sortable:"",style:{"min-width":"10rem"}}),e(t,{field:"profileType",header:"Роль",style:{"min-width":"10rem"}}),e(t,{field:"id",header:"ID профиля",sortable:"",style:{"min-width":"16rem"}}),e(t,{field:"createdAt",header:"Дата создания",sortable:"",style:{"min-width":"12rem"}}),e(t,{field:"updatedAt",header:"Дата обновления",sortable:"",style:{"min-width":"12rem"}}),e(t,{exportable:!1,style:{"min-width":"12rem"}},{body:n(r=>[e(p(b),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:B=>w.editProfile(r.data)},null,8,["onClick"]),e(p(b),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:B=>w.confirmDeleteProfile(r.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"])]),e(F,{visible:y.value,"onUpdate:visible":a[3]||(a[3]=r=>y.value=r),style:{width:"450px"},header:"Модерирование профиля (МП)",modal:!0},{footer:n(()=>[e(p(b),{label:"Отменить",icon:"pi pi-times",text:"",onClick:C}),e(p(b),{label:"Сохранить",icon:"pi pi-check",onClick:D})]),default:n(()=>[i("div",me,[i("div",null,[a[8]||(a[8]=i("div",{class:"block font-bold mb-3"},"Статус профиля",-1)),e(A,{modelValue:o.value.status,"onUpdate:modelValue":a[1]||(a[1]=r=>o.value.status=r),options:N.value,optionLabel:"name",placeholder:"Выберите статус",class:"w-full",invalid:m.value&&!o.value.status},null,8,["modelValue","options","invalid"]),m.value&&!o.value.status?(_(),k("small",ce,"Обязательное поле")):I("",!0)]),i("div",null,[a[9]||(a[9]=i("div",{class:"block font-bold mb-3"},"Комментарий модератора",-1)),e(S,{modelValue:o.value.comment,"onUpdate:modelValue":a[2]||(a[2]=r=>o.value.comment=r),placeholder:"Комментарий",class:"w-full",invalid:m.value&&!o.value.comment},null,8,["modelValue","invalid"]),m.value&&!o.value.comment?(_(),k("small",pe,"Обязательное поле")):I("",!0)])])]),_:1},8,["visible"])])}}};export{je as default};
